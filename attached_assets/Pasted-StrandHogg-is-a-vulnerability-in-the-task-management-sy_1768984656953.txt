StrandHogg is a vulnerability in the task management system on Android that allows an attacker to hijack tasks. This can be exploited such that when the end user starts a legitimate app, instead of actually getting that app, the user is presented with a malicious look-a-like instead.

Risk Rating	Scan Type



Version 3.0 Base Score

6.5	Attack vector: LOCAL	Attack complexity: HIGH
	Privileges required: NONE	User Interaction: REQUIRED
	Scope: UNCHANGED	Confidentiality Impact: HIGH
	Integrity Impact: LOW	Availability Impact: HIGH



CWE	CWE-200	https://cwe.mitre.org/data/definitions/200.html

MSTG	
MSTG-PLATFORM-9	
The app protects itself against screen overlay attacks. (Android only)

OWASP MASVS (v2)	
MASVS-PLATFORM-3	
The app uses the user interface securely.

PCI-DSS (v4.0)	
6.1	
Develop and maintain secure systems and applications
		Processes and mechanisms for developing and maintaining secure systems and software are defined and understood
	6.3	Develop and maintain secure systems and applications
		Security vulnerabilities are identified and addressed

GDPR	
Art-25-GDPR	
Data protection by design and by default
	Art-32-GDPR	Security of processing
Risk Assessment		

One or more than one public facing activities of the application is vulnerable to StandHogg vulnerability.
 
In StrandHogg and regular task hijacking, malicious applications typically deploy one of the following techniques or a selection in tandem:
▪	Task Affinity Manipulation: The malicious application leverages two activities, M1 and M2, wherein M2.taskAffinity = com.victim.app and M2.allowTaskReparenting = true. In the eventuality that the malicious app is opened on M2, M2 would be relocated to the front and the user will interact with the malicious application once the victim application has initiated.
▪	Single Task Mode: In the eventuality that the victim application sets launchMode to singleTask, malicious applications can leverage M2.taskAffinity = com.victim.app to hijack the victim's application task stack.
▪	Task Reparenting: In the eventuality that the victim application sets taskReparenting to true, malicious applications can move the victim's application task to the malicious application's stack.
However, in the case of StrandHogg 2.0, all exported activities without a launchMode of singleTask or singleInstance are affected on vulnerable Android versions.
The launchMode for public activity com.onesignal.notifications.activities.NotificationOpenedActivityAndroid22AndOlder remains unset and hence defaults to standard, which mitigates task hijacking via StrandHogg 1.0 and other deprecated techniques documented since 2015 while persisting app vulnerability to StrandHogg
2.0. This vulnerability affects Android versions 3-9, but was only patched by Google on Android
8 and 9. This increases attack susceptibility for all users running Android 5-7.x, as well as users running unpatched Android 8-9.x devices.
The launchMode for public activity com.digitaloperaocean.webviewcode.nfc.MyNfcActivity remains unset and hence defaults to standard, which mitigates task hijacking via StrandHogg 1.0 and other deprecated techniques documented since 2015 while persisting app vulnerability to StrandHogg 2.0. This vulnerability affects Android versions 3-9, but was only patched by Google on Android 8 and 9. This increases attack susceptibility for all users running Android 5-7.x, as well as users running unpatched Android 8-9.x devices.
The launchMode for public activity com.digitaloperaocean.webviewcode.SplashScreenActivity remains unset and hence defaults to standard, which mitigates task hijacking via StrandHogg 1.0 and other deprecated techniques documented since 2015 while persisting app vulnerability to StrandHogg 2.0. This vulnerability affects Android versions 3-9, but was only patched by Google on Android 8 and 9. This increases attack susceptibility for all users running Android 5-7.x, as well as users running unpatched Android 8-9.x devices.
The launchMode for public activity com.onesignal.NotificationOpenedActivityHMS remains unset and hence defaults to standard, which mitigates task hijacking via StrandHogg 1.0 and other deprecated techniques documented since 2015 while persisting app vulnerability to StrandHogg
2.0. This vulnerability affects Android versions 3-9, but was only patched by Google on Android
8 and 9. This increases attack susceptibility for all users running Android 5-7.x, as well as users running unpatched Android 8-9.x devices.
The launchMode for public activity com.digitaloperaocean.webviewcode.MainActivity is set as singleTask. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/onesignal/notifications/ internal/common/GenerateNotificationOpenIntent;->getIntentAppOpen()Landroid/content/Intent; [access_flags=private final] @ 0x4e830c. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/digitaloperaocean/ webviewcode/MainActivity$MyWebViewClient;->shouldOverrideUrlLoading(Landroid/webkit/WebView;
 
Ljava/lang/String;)Z [access_flags=public] @ 0x1182c. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/google/firebase/ messaging/CommonNotificationBuilder;->createTargetIntent(Ljava/lang/String; Lcom/google/ firebase/messaging/NotificationParams; Landroid/content/pm/PackageManager;)Landroid/content/ Intent; [access_flags=private static] @ 0x450078. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/digitaloperaocean/ webviewcode/MainActivity;->foreground(Ljava/lang/String; Ljava/lang/String;)V [access_flags=private] @ 0x14670. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/google/android/gms/ internal/ads/zzbql;->zzb()Landroid/content/Intent; [access_flags=final] @ 0x1fc114. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/google/android/gms/ internal/consent_sdk/zzbt;->startActivity(Landroid/content/Intent;)V [access_flags=public final] @ 0x33fb60. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/google/android/gms/ internal/ads/zzcgk;->startActivity(Landroid/content/Intent;)V [access_flags=public final] @ 0x224fa4. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/pushwoosh/n/d;-
>a(Landroid/content/Context;)V [access_flags=private] @ 0x52da50. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/pushwoosh/notification/ a;->a()Landroid/content/Intent; [access_flags=private static] @ 0x5307dc. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/digitaloperaocean/ webviewcode/WebViewApp$1;->onClick(Lcom/onesignal/notifications/INotificationClickEvent;)V [access_flags=public] @ 0x19584. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.
A new activity is launched with flag FLAG_ACTIVITY_NEW_TASK set in Lcom/pushwoosh/notification/ a;->a(Lcom/pushwoosh/notification/PushMessage;)V [access_flags=] @ 0x530950. As a result, a malicious applications can leverage taskAffinity='com.victim.app' to hijack the victim's application task stack.



<activity android:theme="@style/AppTheme.NoActionBar" android:name="com.demo.MainActivity" android:exported="true" android:screenOrientation="portrait" android:windowSoftInputMode="adjustNothing">
 

 

<activity android:theme="@style/AppTheme.NoActionBar" android:name="com.demo.MainActivity" android:exported="true" android:screenOrientation="portrait" android:windowSoftInputMode="adjustNothing" android:launchMode="singleInstance" android:taskAffinity="">



A malicious app could leverage this weakness to manipulate the way in which users interact with the app. Specifically, this could be instigated by relocating a malicious attacker-controlled activity in the screen flow of the user, which may prove useful towards performing phishing, DoS or user-credential capture. This issue has been verified as a known exploit leveraged by banking malware Trojans in the past.


▪	Towards Discovering and Understanding Task Hijacking in Android
