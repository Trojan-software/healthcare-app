<?xml version="1.0" encoding="utf-8"?>
<!--
    Network Security Configuration
    Security: CRITICAL (9.1) - Comprehensive Network Security
    
    ADHCC Compliance: Network Security + Certificate Pinning
    
    This configuration enforces:
    1. HTTPS-only communication (cleartext disabled globally)
    2. SSL Certificate Pinning for production domains
    3. User-installed CA certificates BLOCKED
    4. No debug overrides in production
    
    Compliance: OWASP MASVS-NETWORK-1, MASVS-NETWORK-2, PCI-DSS 4.1-4.2, HIPAA 164.312(e)
    
    Certificate pins generated: January 2026
    Pins must be regenerated when SSL certificates are renewed.
-->
<network-security-config>
    
    <!-- Base configuration - HTTPS-only globally, NO user certs -->
    <base-config cleartextTrafficPermitted="false">
        <trust-anchors>
            <certificates src="system" />
        </trust-anchors>
    </base-config>
    
    <!-- Production Configuration - HTTPS-Only, Certificate Pinning -->
    <domain-config cleartextTrafficPermitted="false">
        <domain includeSubdomains="true">247tech.net</domain>
        <domain includeSubdomains="true">api.247tech.net</domain>
        
        <!-- Trust only system certificates -->
        <trust-anchors>
            <certificates src="system" />
        </trust-anchors>
        
        <!-- Certificate Pinning - SHA-256 Public Key Pins -->
        <pin-set expiration="2027-01-21">
            <!-- Primary certificate pin (leaf certificate) -->
            <pin digest="SHA-256">Rktl1AzSr30CuXGSV3uEGnF5MYEXy3w655PEvZ3EV2Y=</pin>
            <!-- Backup pin (intermediate CA certificate) -->
            <pin digest="SHA-256">y7xVm0TVJNahMr2sZydE2jQH8SquXV9yLF9seROHHHU=</pin>
        </pin-set>
    </domain-config>
    
</network-security-config>
