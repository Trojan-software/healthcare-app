<?xml version="1.0" encoding="utf-8"?>
<!--
    Network Security Configuration
    Security: CRITICAL (9.1) - Comprehensive Network Security
    
    ADHCC Compliance: Network Security Misconfiguration Fix
    
    This configuration enforces:
    1. HTTPS-only communication (cleartext disabled globally)
    2. SSL Certificate Pinning for production domains
    3. User-installed CA certificates BLOCKED
    4. No debug overrides in production
    
    Compliance: OWASP MASVS-NETWORK-1, PCI-DSS 4.1-4.2, HIPAA 164.312(e)
-->
<network-security-config>
    
    <!-- Base configuration - HTTPS-only globally, NO user certs -->
    <base-config cleartextTrafficPermitted="false">
        <trust-anchors>
            <certificates src="system" />
        </trust-anchors>
    </base-config>
    
    <!-- Production Configuration - HTTPS-Only, Certificate Pinning -->
    <domain-config cleartextTrafficPermitted="false">
        <domain includeSubdomains="true">247tech.net</domain>
        <domain includeSubdomains="true">api.247tech.net</domain>
        
        <!-- Trust only system certificates -->
        <trust-anchors>
            <certificates src="system" />
        </trust-anchors>
        
        <!-- Certificate Pinning -->
        <pin-set expiration="2027-12-31">
            <!-- 
                Generate pins for production using:
                openssl s_client -servername 247tech.net -connect 247tech.net:443 2>/dev/null | \
                openssl x509 -pubkey -noout | \
                openssl pkey -pubin -outform der | \
                openssl dgst -sha256 -binary | \
                base64
            -->
            <pin digest="SHA-256">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=</pin>
            <pin digest="SHA-256">BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=</pin>
        </pin-set>
    </domain-config>
    
</network-security-config>
